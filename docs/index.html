<!-- HTML header for doxygen 1.8.20-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EPC9143 300 W 16th Brick DC/DC Module Reference Design: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mchp.css" rel="stylesheet" type="text/css"/>
<link href="mchp_theme.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" style="background-color: #000000;">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 36px;">
  <td id="projectlogo" style="padding-left: 0.2em; vertical-align: middle;"><img alt="Logo" src="microchip-docs.png"/></td>
  <td id="projectalign" style="padding-left: 0.0em;">
   <div id="projectname" style="color: white; font-size:16px;">EPC9143 300 W 16th Brick DC/DC Module Reference Design
   </div>
  </td>
   <td style="padding-top: 10px; height: 20px; vertical-align: top;">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">EPC9143 300 W 16th Brick DC/DC Module Reference Design Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_D__Firmware_MCU16ASMPS_FirmwareProjects_epc9143-power-advanced-voltage-mode-control_README"></a><img src="microchip.jpg" alt="" class="inline" title="image"/>   </p>
<h2>EPC9143 300W 16th Brick Non-Isolated Step Down Converter Advanced Voltage Mode Control Firmware</h2>
<p><b>2-Phase Synchronous Buck Converter with Advanced Voltage Mode Control and Current Balancing</b></p>
<table style="border: none; align:center; width:100%">
<tr>
<td style="align:center;"></td><td style="text-align:center; vertical-align: bottom; height:230px; width:300px;"><img src="images/9143_r4.png" alt="EPC9143 Top View" width="300" class="inline"/>  </td><td style="align:center; width:10px">&#160;  </td><td style="text-align:center; vertical-align: bottom; height:230px; width:300px"><img src="images/9143_r4_back.png" alt="EPC9143 Bottom View" width="288" class="inline"/>  </td><td style="align:center;"></td></tr>
<tr>
<td style="align:center;"></td><td align="center"><b>Top View</b>  </td><td style="align:center;">&#160;  </td><td align="center"><b>Bottom View</b> </td><td style="align:center;"></td></tr>
</table>
<h2>Summary</h2>
<p>This code example demonstrates a closed loop voltage mode control implementation for dsPIC33CK. It has specifically been developed for the EPC9143 1/16th brick power module, hardware revision 4.0 (see 'Rev' number printed on board top view shown above for verification).</p>
<p>The board starts up automatically when sufficient power is applied to the input terminals of the board, providing a regulated output voltage of 12 V DC at the output of the converter. The startup procedure is controlled and executed by the power controller state machine and includes a configurable startup procedure with power-on delay, ramp up period and power good delay before dropping into constant regulation mode.</p>
<p>An additional fault handler routine continuously monitors incoming ADC data and peripheral status bits and shuts down the power supply if the input voltage is outside the defined maximum range (UVLO/OVLO) or if the output voltage is more than 0.5 V out of regulation for more than 10 milliseconds.</p>
<p>A single, high-speed type IV (4P4Z) voltage mode controller with enforced PWM steering is used to automatically create balanced phase currents in both phases of this interleaved converter. An underlying current balancing scheme compensates component tolerances and deviations over temperature. A built-in adaptive gain control algorithm stabilizes gain variations of the voltage loop controller during input- and output voltage transients, stabilizing cross-over frequency and output impedance, supporting control bandwidths of 25 kHz, for improved transient response, helping to minimize power distribution network (PDN) decoupling capacity.</p>
<h4>Product Features:</h4>
<ul>
<li>Input Voltage: 18 V to 61 V</li>
<li>Output Voltage: 5 ... 15 V DC (12 V default setting)</li>
<li>Switching Frequency: 500 kHz</li>
<li>Control Frequency: 500 kHz</li>
<li>Cross-Over Frequency: ~25 kHz (depends on VIN and if AGC is on/off)</li>
<li>Phase Margin: ~ 50°</li>
<li>Gain Margin: ~ 12 dB</li>
</ul>
<h2>Related Documentation</h2>
<h5>Firmware Documentation</h5>
<ul>
<li><a href="https://microchip-pic-avr-solutions.github.io/epc9143-power-advanced-voltage-mode-control">EPC9143 Online Firmware Documentation</a></li>
</ul>
<h5>Hardware Documentation</h5>
<ul>
<li><a href="https://www.microchip.com/DevelopmentTools/ProductDetails/PartNO/EPC9143">EPC9143 300W 1/16th brick Power Module Reference Design Product Website</a><ul>
<li><a href="https://epc-co.com/epc/documents/guides/EPC9143_qsg.pdf">EPC9143 Reference Design Quick Start Guide (QSG)</a></li>
<li><a href="https://epc-co.com/epc/documents/schematics/EPC9143_Schematic.pdf">EPC9143 Reference Design Schematics</a></li>
<li><a href="https://epc-co.com/epc/documents/guides/EPC9531_qsg.pdf">EPC9531 Test Fixture Quick Start Guide (QSG)</a></li>
<li><a href="https://epc-co.com/epc/documents/schematics/EPC9531_Schematic.pdf">EPC9531 Test Fixture Schematics</a></li>
</ul>
</li>
</ul>
<h5>Device Support</h5>
<p><em>Featured Microchip Technology Products:</em></p><ul>
<li><a href="https://www.microchip.com/dsPIC33CK32MP102">dsPIC33CK32MP102 Product Website</a><ul>
<li><a href="https://www.microchip.com/DS70005363">dsPIC33CKxxMP10x Device Family Data Sheet</a></li>
<li><a href="https://www.microchip.com/DS80000809">dsPIC33CKxxMP10x Device Family Silicon Errata and Data Sheet Clarification</a></li>
</ul>
</li>
<li><a href="https://www.microchip.com/MCP6C02">MCP6C02 Shunt Amplifier Product Website</a><ul>
<li><a href="https://www.microchip.com/DS20006129">MCP6C02 Zero-Drift, High-Side Current Sense Amplifier</a></li>
</ul>
</li>
</ul>
<p><em>Featured Efficient Power Conversion (EPC) Products:</em></p><ul>
<li><a href="https://epc-co.com/epc/Products/eGaNFETsandICs/EPC2053.aspx">EPC2053 100 V, 48/246 A Enhancement-Mode GaN Power Transistor</a><ul>
<li><a href="https://epc-co.com/epc/Portals/0/epc/documents/datasheets/EPC2053_datasheet.pdf">EPC2053 Data Sheet</a></li>
</ul>
</li>
</ul>
<h2>Development Tools</h2>
<h5>MPLAB® X Integrated Development Environment (IDE)</h5>
<ul>
<li><a href="https://www.microchip.com/mplabx">Requires MPLAB® X IDE, Version v5.40 or later</a><ul>
<li><a href="https://www.microchip.com/mplabx-ide-windows-installer">Download latest version of MPLAB® X IDE for Windows</a></li>
<li><a href="https://www.microchip.com/mplabx-ide-linux-installer">Download latest version of MPLAB® X IDE for Linux</a></li>
<li><a href="https://www.microchip.com/mplabx-ide-osx-installer">Download latest version of MPLAB® X IDE for MAC OS</a></li>
</ul>
</li>
</ul>
<h5>MPLAB® XC16 C-Compiler</h5>
<ul>
<li><a href="https://www.microchip.com/xc16">Requires MPLAB® XC16 Compiler, Version v1.50 or later</a><ul>
<li><a href="https://www.microchip.com/mplabxc16windows">Download latest version of MPLAB® XC16 Compiler for Windows</a></li>
<li><a href="https://www.microchip.com/mplabxc16linux">Download latest version of MPLAB® XC16 Compiler for Linux</a></li>
<li><a href="https://www.microchip.com/mplabxc16osx">Download latest version of MPLAB® XC16 Compiler for MAC OS</a></li>
</ul>
</li>
</ul>
<h5>MPLAB® X PowerSmart™ Digital Control Library Designer</h5>
<ul>
<li><a href="https://areiter128.github.io/DCLD/">Optional: PowerSmart&trade; - Digital Control Library Designer, v0.9.12.642 or later (Pre-Release Version)</a><ul>
<li><a href="https://github.com/areiter128/DCLD/archive/release.zip">Download latest version of PowerSmart&trade; - DCLD for Windows</a></li>
</ul>
</li>
</ul>
<h2>Hardware Used</h2>
<p>The EPC9143 1/16th brick power module is best tested when plugged into EPC9531 test fixture. This test fixture also provides all required interfaces to program and debug the dsPIC33CK32MP102 DSC as well as test points and banana jack connectors for easy and safe handling of the kit during bench tests. The EPC9531 QSG provides detailed operating procedure instructions.</p>
<ul>
<li>EPC9143: EPC9143 16th Brick Non-Isolated Step Down Converter, Revision 4.0</li>
<li>EPC9531: EPC9531 test fixture for EPC9143 16th brick reference design</li>
</ul>
<center> <img src="images/9531_test_fixture.png" alt="EPC9143 mounted on EPC9531 Test Fixture" width="500" class="inline"/> </center> <h2>Setup</h2>
<p>The board comes programmed and ready to be used when unpacked. No reprogramming of the target device is required to operate the board unless features or settings such as the nominal output voltage or start-up timing need to be modified.</p>
<center> <img src="images/9531_9143_setup.png" alt="EPC9531 Test Fixture Connections - Top View" width="700" class="inline"/> <br  />
 EPC9531 Test Fixture Connections - Top View </center> <center> <img src="images/9531_bottom.png" alt="EPC9531 Test Fixture Connections - Bottom View" width="620" class="inline"/> <br  />
 EPC9531 Test Fixture Connections - Bottom View </center> <p>In case firmware based features need to be changed, the Microchip dsPIC33CK controller can be re-programmed using the in-circuit serial programming port (ICSP) available on the RJ-11 programming interface as well as the 5-pin header provided by the EPC9531 test fixture. These interfaces support all of Microchip’s in-circuit programmers/debuggers, such as MPLAB® ICD4, MPLAB® REAL ICE or MPLAB® PICkit4 and previous derivatives. See <a href="https://epc-co.com/epc/documents/guides/EPC9531_qsg.pdf">EPC9531 Quick Start Guide</a> for details.</p>
<h2>Operation</h2>
<p>The converter is starting up automatically when more than 10.5 V DC are applied across the input terminals of the EPC9531 test fixture. It is not recommended to operate the EPC9143 reference design without proper decoupling capacitance at either input or output. The EPC9531 test fixture provides the best test environment for the converter. Please read the <a href="https://epc-co.com/epc/documents/guides/EPC9531_qsg.pdf">EPC9531 Quick Start Guide</a> to get detailed information about the requirements for setup and operation of this reference design.</p>
<h5>Cycle-by-Cycle Voltage Control Loop</h5>
<p>This firmware uses a digital type IV controller to close the feedback loop in voltage mode control. This digital loop reads the most recent ADC sample of the output voltage and processes the derived value through a digital type IV (4P4Z) compensation filter. The numeric output is checked and, when necessary, clamped to user-defined minimum/maximum thresholds before being written to the PWM duty cycle register. As EPC9143 is a multiphase converter, a special PWM steering mode has been implemented supporting high-speed current balancing between the two phases. The voltage mode controller has been extended with a self-adapting loop gain tuning algorithm (AGC) stabilizing the frequency domain characteristic over input voltage, output voltage and load, always providing the exact same bandwidth of &gt;25 kHz and stability margins across the entire operating range.</p>
<center> <img src="images/type4-avmc.png" alt="EPC9143 type IV - Advanced Voltage Control Loop" width="800" class="inline"/> <br  />
 EPC9143 Type IV Controller - Advanced Voltage Control Loop </center> <p>This control loop can be turned on/off by using the ENABLE bit in the STATUS word of the cNPNZ_t controller data structure. The adaptive loop gain modulation is permanently active as soon as the control loop is enabled.</p>
<p>The control loop source code is configured and generated by the PowerSmart&trade; - Digital Control Library Designer (DCLD) software.</p>
<p>This additional design software is available for download on Github Pages:</p>
<ul>
<li><a href="https://areiter128.github.io/DCLD">PowerSmart&trade; Digital Control Library Designer Github Page</a></li>
</ul>
<p>Once installed, the controller configuration can be modified. The most recent configuration can be opened from within the MPLAB X® IDE by right-clicking on the file **'v_loop.dcld'** located in the Important Files folder of the Project Manager. When right-clicked, select **'Open In System'** to open the configuration in PowerSmart&trade; DCLD.</p>
<p>Please refer to the user guide of PowerSmart&trade; DCLD which is included in the software and can be opened from the help menu of the application.</p>
<hr  />
<p> (c) 2020, Microchip Technology Inc. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.20-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <p style="height: 12px; padding-bottom: 8px; padding-right: 12px; vertical-align: bottom; text-align: right; font-size: 90%;">© 2020, Microchip Technology Inc.</p>
  </ul>
</div>
</body>
</html>
